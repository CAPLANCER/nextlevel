Option Explicit

Sub Formatting(lastRow As String)

    Dim ws As Worksheet
    Dim lr As Long

    ' Convert lastRow (coming from UiPath as String)
    If IsNumeric(lastRow) Then
        lr = CLng(lastRow)
    Else
        MsgBox "Invalid lastRow received: " & lastRow, vbCritical
        Exit Sub
    End If

    Set ws = ThisWorkbook.ActiveSheet

    Application.ScreenUpdating = False

    ' === 1. Auto-fit ===
    ws.Cells.EntireColumn.AutoFit

    ' === 2. Set Row Height from A4 to lastRow ===
    ws.Rows("4:" & lr).RowHeight = 57

    ' === 3. Apply Number Formatting ===
    ' 0 decimals → E, G, J, K, L, M, X, Y
    ws.Range("E4:E" & lr).NumberFormat = "0"
    ws.Range("G4:G" & lr).NumberFormat = "0"
    ws.Range("J4:J" & lr).NumberFormat = "0"
    ws.Range("K4:K" & lr).NumberFormat = "0"
    ws.Range("L4:L" & lr).NumberFormat = "0"
    ws.Range("M4:M" & lr).NumberFormat = "0"
    ws.Range("X4:X" & lr).NumberFormat = "0"
    ws.Range("Y4:Y" & lr).NumberFormat = "0"

    ' 2 decimals → F
    ws.Range("F4:F" & lr).NumberFormat = "0.00"

    Application.ScreenUpdating = True

End Sub
