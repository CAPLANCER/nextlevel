Option Explicit

Sub DeleteRows_ByScheme()
    Dim ws As Worksheet
    Dim lastRow As Long, r As Long
    Dim schemeName As String
    
    ' Ask user for scheme name
    schemeName = InputBox("Enter Scheme Name to delete:", "Delete Scheme Rows")
    If Trim(schemeName) = "" Then Exit Sub
    
    Set ws = ActiveSheet
    lastRow = ws.Cells(ws.Rows.Count, "G").End(xlUp).Row
    
    Application.ScreenUpdating = False
    
    ' Loop backwards to safely delete rows
    For r = lastRow To 1 Step -1
        If LCase(Trim(ws.Cells(r, "G").Value)) = LCase(Trim(schemeName)) Then
            ws.Rows(r).Delete
        End If
    Next r
    
    Application.ScreenUpdating = True
    MsgBox "All rows with scheme '" & schemeName & "' have been deleted.", vbInformation
End Sub
