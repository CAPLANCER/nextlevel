Below is the complete SDD in plain text format, cleanly structured so you can copy–paste directly into a Word document.
No formatting elements that break—fully text-only, easy to edit.


---

============================================================
==================== SOLUTION DESIGN DOCUMENT (SDD) ====================

Project Name: Mobile Bill Automation
Version: 1.0
Prepared By: RPA Developer – Shushank
Purpose: This document defines the technical solution design, workflow details, data processing logic, and exception handling implemented in the Mobile Bill Automation process.


---

1. INTRODUCTION

1.1 Purpose
The purpose of this Solution Design Document (SDD) is to describe the technical design for automating mobile bill processing. The automation extracts call records from PDF files, processes and filters call data, converts the data into structured JSON using Gemini, prepares an Excel output file, applies business rules, and sends the final processed file to business users.

1.2 Scope
This process includes:

Reading PDF files from shared drive

Extracting call records

Filtering relevant data

Calling Gemini API for JSON conversion

Creating and formatting Excel output

Applying business rules

Sending final files as email output



---

2. INPUT SOURCES

2.1 PDF Input Files
PDF files are received on the shared drive.
File Name Format:
<UserName>_<Operator>_<MonthYear>.pdf
Example: ShushankYadav_Jio_Dec2025.pdf

2.2 Supporting Input Files Provided by Business

1. Mobile Number Master (sheet: Mobile)


2. Landline Number Master (sheet: Landline)


3. Holiday List (dates)


4. Market Segment Mapping File (User → Segment → Market Timing)




---

3. HIGH-LEVEL PROCESS OVERVIEW

1. Retrieve PDF file from shared drive


2. Convert PDF to text using Python


3. Detect operator and extract call records section


4. Send filtered call records to Gemini


5. Receive JSON output


6. Convert JSON to DataTable


7. Apply business transformation rules


8. Create output Excel using template


9. Format Excel file


10. Email output files to users




---

4. DETAILED PROCESS DESIGN


---

4.1 Initialization (REFramework)

Load Config file

Initialize dictionaries, counters

Load Master Files (Mobile Master, Landline Master, Market Mapping, Holiday File)

Prepare Gemini API authentication

Store paths for Input, Output, Template

Log "process start time"



---

4.2 Reading Input Files

1. Fetch all files from shared input folder.


2. Validate file name pattern.


3. Extract from file name:

Username

Operator

Billing Month & Year



4. Store these values for later use.




---

5. PDF → TEXT CONVERSION (Python Script #1)

PDF is opened in Python.

Extract text from each page.

Since the PDFs are digitally generated, conversion is accurate.

Output: Raw text file.

Delete temporary text after extraction.



---

6. CALL RECORD EXTRACTION (Python Script #2)

Problem: PDF text contains irrelevant data that increases Gemini token usage.

Solution:

Detect operator from file name (Jio, Airtel, Vi).

Load corresponding keyword set.

Extract only the text between defined boundary keywords.

This reduces:

Processing time

Memory usage

Token consumption



Output: Filtered call records text only.


---

7. GEMINI PROCESSING (Python Script #3)

Input: Filtered call record text
Output: JSON containing rows of:

Date

Time

Number

Duration


Error Handling:

If Gemini fails or returns malformed JSON, log as business exception.

Skip to next file without stopping the process.



---

8. JSON → DATATABLE CONVERSION

Convert JSON response into a DataTable.

Columns created:

Date

Time

Number

Duration




---

9. BUSINESS TRANSFORMATION RULES

Below rules are applied on each row in the DataTable.


---

9.1 Username Extraction

From filename:
Example: ShushankYadav_Jio_Dec2025
Split by _ → Username = first part.


---

9.2 Date Normalization

Different operators supply dates in different formats.

Supported formats are checked.

Convert date to final required format:
DD/MM/YYYY



---

9.3 Time Normalization

Convert 24-hour formats to 12-hour format.

Validate HH:mm:ss if available.

Standard output format:
hh:mm tt



---

9.4 Number Normalization

Steps:

Remove +91, 0091 and leading zeros.

Ensure mobile numbers become 10-digit format.

Landline numbers retain structure based on area code and master sheet.



---

9.5 Duration Normalization

Duration may come in various formats:

Only seconds (e.g., 90)

mm:ss

hh:mm:ss


Output rules:

If < 60 sec → 00:ss

If < 60 min → mm:ss

Else → hh:mm:ss


Examples:

49 sec → 00:49

39 min 47 sec → 39:47

1 hr 39 min 49 sec → 01:39:49



---

9.6 Market Segment Assignment

Using Market Segment Mapping File:
Username → Segment

For each segment, identify market time range.

Market Start & End time retrieved for further checks.



---

9.7 Market Timing Check

Compare call time with market time.

If call time falls between start & end → "Market"

Else → "Outside Market"



---

9.8 Number Classification: Mobile / Landline

Rules:

Numbers starting with 6–9 → Mobile

Others → Landline


Further validation:

Check against Mobile Master and Landline Master.

If match → "Internal = Yes"

Else → "Internal = No"



---

9.9 Holiday / Working Day Logic

1. If call date exists in Holiday List → Mark as Holiday


2. Else if Saturday or Sunday → Mark as Holiday


3. Else → Mark as Working Day




---

10. OUTPUT FILE CREATION

Steps:

1. Copy Excel Template to Output Folder.


2. File Name Example:
ShushankYadav_Jio_Dec2025.xlsx


3. Write DataTable to the template Excel.


4. Save and close Excel.




---

11. EXCEL FORMATTING

Autofit columns

Apply borders

Apply alignment

Format duration, date, and number columns

Apply conditional formatting if necessary

Execute VBA macro if required

Kill Excel process to release lock



---

12. EMAIL OUTPUT

Subject:
Mobile Bill Automation – Processed Output

Body:
"Please find attached the processed file(s) for Mobile Bill Automation."

Attachments:

All processed Excel files

Exception file (if applicable)



---

13. EXCEPTION HANDLING

Summary of exceptions and handling method:

Business Exceptions:

Invalid date/time format → Add to business exception log

Missing call records → Log and continue

Number not recognized → Mark as "Unknown"


System Exceptions:

Python failure → Retry 3 times

Gemini failure → Retry, else log and continue

File access error → Delay and retry

Excel lock → Kill Excel and continue



---

14. PERFORMANCE OPTIMIZATION

Filtering call records before Gemini reduces processing time.

DataTable manipulation uses LINQ for speed.

Workbook activities used instead of Excel for faster writes.

Reused Python engine for consecutive operations.



---

15. DEPENDENCIES

Software:

UiPath Studio (2023.10.1)

Python 3.x

Gemini API

MS Excel


Files:

Mobile Master

Landline Master

Holiday List

Market Segment Mapping

Excel Template



---

16. CONCLUSION

The Mobile Bill Automation process fully automates PDF processing, JSON generation, business rule application, and Excel report preparation. The solution ensures accuracy, consistency, and significant reduction in manual effort.


---

If you want, I can also generate:

Process Flow Diagram (ASCII or image)

Exception Matrix

Config.xlsx Template

Folder Structure Diagram

Test Scenarios (TDD)


Just tell me what you need.
