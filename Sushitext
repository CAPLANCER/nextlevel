Sub AutoFilterAndSort_AllSheets()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim rng As Range

    Application.ScreenUpdating = False
    Application.EnableEvents = False

    For Each ws In ThisWorkbook.Worksheets
        ' Skip Summary and Pds
        If ws.Name <> "Summary" And ws.Name <> "Pds" Then
            With ws
                ' Find the last row based on column A
                lastRow = .Cells(.Rows.Count, "A").End(xlUp).Row

                ' Only proceed if there is data beyond header
                If lastRow > 3 Then
                    ' Define the range from A3 to I:lastRow
                    Set rng = .Range("A3:I" & lastRow)

                    ' Clear any existing filters
                    If .AutoFilterMode Then .AutoFilterMode = False

                    ' Apply AutoFilter to the range
                    rng.AutoFilter

                    ' Sort by column I (the 9th column of range), descending
                    rng.Sort Key1:=.Range("I3"), Order1:=xlDescending, Header:=xlYes
                End If
            End With
        End If
    Next ws

    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub
