
Function GetLastRow(sheetName As String) As Long
    Dim ws As Worksheet
    Dim lastRow As Long
    
    On Error GoTo ErrHandler
    
    Set ws = ThisWorkbook.Sheets(sheetName)
    
    'Find the last non-empty row in column A starting from A4
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    'If the last row is above row 4, then return 4 (meaning no data below A4)
    If lastRow < 4 Then
        lastRow = 4
    End If
    
    GetLastRow = lastRow
    Exit Function
    
ErrHandler:
    GetLastRow = -1  'Return -1 in case of error
End Function