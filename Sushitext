Sub AutoFilterAndSort()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim rng As Range

    ' Work on the active sheet (change to ThisWorkbook.Worksheets("SheetName") if needed)
    Set ws = ActiveSheet

    ' Find the last row based on column A
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    ' Define the full range starting from A3 to last row, up to column I
    Set rng = ws.Range("A3:I" & lastRow)

    ' Clear any existing filters
    If ws.AutoFilterMode Then ws.AutoFilterMode = False

    ' Apply AutoFilter to the defined range
    rng.AutoFilter

    ' Sort by column I (the 9th column of the range), descending
    rng.Sort Key1:=ws.Range("I3"), Order1:=xlDescending, Header:=xlYes
End Sub
